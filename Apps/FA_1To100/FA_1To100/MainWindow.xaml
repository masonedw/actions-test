<Window x:Class="FA_1To100.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FA_1To100"
        mc:Ignorable="d"
        xmlns:ports="clr-namespace:System.IO.Ports;assembly=System"
        Title="MainWindow" Height="250" Width="390"
        xmlns:core="clr-namespace:FA_1To100.Core"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:ViewModel="clr-namespace:FA_1To100.MVVM.ViewModel"
        Background="LightGray">
    <Window.DataContext>
        <ViewModel:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <ObjectDataProvider ObjectType="{x:Type ports:SerialPort}"
                            MethodName="GetPortNames" x:Key="portNames">
        </ObjectDataProvider>

        <ObjectDataProvider x:Key="parityEnum" 
                            MethodName="GetValues" 
                            ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="core:ParityType"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <ObjectDataProvider x:Key="stopBitEnum" 
                            MethodName="GetValues" 
                            ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="core:StopBitsType"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>

    <Grid>
        
        <StackPanel Orientation="Horizontal"
                    VerticalAlignment="Center"
                    Margin="10,0,0,0">
            <Border BorderThickness="1"
                    BorderBrush="Gray"
                    Padding="10"
                    CornerRadius="5">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal">
                        <Label Content="COM:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  SelectedIndex="1"
                                  VerticalContentAlignment="Center"
                                  ItemsSource="{Binding Source={StaticResource portNames}}"
                                  SelectedItem="{Binding COMPort}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Baud:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <TextBox Height="25"
                                  Width="80"
                                 Text="{Binding BaudRate}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Parity:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  VerticalContentAlignment="Center"
                                  SelectedIndex="1"
                                  ItemsSource="{Binding Source={StaticResource parityEnum}}"
                                  SelectedItem="{Binding Parity}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Stop Bits:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  SelectedIndex="1"
                                  VerticalContentAlignment="Center"
                                  ItemsSource="{Binding Source={StaticResource stopBitEnum}}"
                                  SelectedItem="{Binding StopBits}"/>
                    </StackPanel>

                    <Button Height="20"
                            Width="70"
                            Content="{Binding SerialConnectionStatus}"
                            Margin="0,10,0,0"
                            Command="{Binding ConnectToSerial}"/>
                </StackPanel>
            </Border>
            
            <StackPanel Orientation="Vertical"
                        Margin="20,20,0,0">
                <Label Content="1 To 100 App"
                       FontSize="16"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"/>

                <StackPanel Orientation="Horizontal"
                            Margin="-30,10,0,0"
                            HorizontalAlignment="Center">
                    <Label Content="FA_"
                           Width="30"/>
                    <TextBox Height="25"
                             Width="60"
                             HorizontalContentAlignment="Center"
                             VerticalContentAlignment="Center"
                             PreviewTextInput="TextBox_PreviewTextInput"
                             PreviewKeyDown="TextBox_PreviewKeyDown"
                             MaxLength="3"
                             Text="{Binding MessageText}"/>
                </StackPanel>

                <StackPanel Orientation="Vertical"
                            Margin="0,20,0,0">
                    <Button Content="Send Message"
                            Height="30"
                            Width="100"
                            Background="White"
                            Command="{Binding SendMessage}"/>
                    <Label Foreground="Red"
                           Content="Enter a value between 1 and 100"
                           Visibility="Hidden"/>
                </StackPanel>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
