<Window x:Class="FA_1To100.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FA_1To100"
        mc:Ignorable="d"
        xmlns:ports="clr-namespace:System.IO.Ports;assembly=System"
        Title="MainWindow" Height="450" Width="600"
        xmlns:core="clr-namespace:FA_1To100.Core"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:ViewModel="clr-namespace:FA_1To100.MVVM.ViewModel"
        Background="LightGray"
        ResizeMode="NoResize">
    <Window.DataContext>
        <ViewModel:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <ObjectDataProvider ObjectType="{x:Type ports:SerialPort}"
                            MethodName="GetPortNames" x:Key="portNames">
        </ObjectDataProvider>

        <ObjectDataProvider x:Key="parityEnum" 
                            MethodName="GetValues" 
                            ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="core:ParityType"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <ObjectDataProvider x:Key="stopBitEnum" 
                            MethodName="GetValues" 
                            ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="core:StopBitsType"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <Style x:Key="RoundedButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="25"/>
            <Setter Property="Width" Value="40"/>

            <!-- Adding CornerRadius to make the button's corners round -->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="buttonBorder"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="buttonBorder" Property="Background" Value="#111111"/>
                                <Setter TargetName="buttonBorder" Property="BorderBrush" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="1*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="FA Remote"
                   FontSize="20"
                   FontWeight="Bold"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
        <StackPanel Orientation="Horizontal"
                    Margin="10,0,0,30"
                    Grid.Row="1">
            <Border BorderThickness="1"
                    BorderBrush="Gray"
                    Padding="10"
                    CornerRadius="5"
                    VerticalAlignment="Center">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal">
                        <Label Content="COM:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  SelectedIndex="1"
                                  VerticalContentAlignment="Center"
                                  ItemsSource="{Binding Source={StaticResource portNames}}"
                                  SelectedItem="{Binding COMPort}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Baud:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <TextBox Height="25"
                                  Width="80"
                                 Text="{Binding BaudRate}"
                                 VerticalContentAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Parity:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  VerticalContentAlignment="Center"
                                  SelectedIndex="1"
                                  ItemsSource="{Binding Source={StaticResource parityEnum}}"
                                  SelectedItem="{Binding Parity}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,5,0,0">
                        <Label Content="Stop Bits:"
                               Width="60"
                               HorizontalContentAlignment="Right"/>
                        <ComboBox Height="25"
                                  Width="80"
                                  SelectedIndex="1"
                                  VerticalContentAlignment="Center"
                                  ItemsSource="{Binding Source={StaticResource stopBitEnum}}"
                                  SelectedItem="{Binding StopBits}"/>
                    </StackPanel>

                    <Button Height="20"
                            Width="70"
                            Content="{Binding SerialConnectionStatus}"
                            Margin="0,10,0,0"
                            Command="{Binding ConnectToSerial}"/>

                    <Border Background="Black"
                            Height="1"
                            Margin="0,20,0,10"/>

                    <StackPanel Orientation="Vertical"
                                HorizontalAlignment="Center">
                        <CheckBox Content="Prepend fa_"
                                  HorizontalAlignment="Center"
                                  IsChecked="{Binding PrependFA}"
                                  Margin="0,0,0,10"/>

                        <GroupBox Header="Line Terminator"
                                  Padding="10,5,10,0"
                                  BorderBrush="Black"
                                  BorderThickness="0.5"
                                  >
                            <StackPanel Orientation="Vertical">
                                <RadioButton Content="Carriage Return"
                                             IsChecked="{Binding AppendCR}"
                                             VerticalContentAlignment="Center"
                                             Margin="0,0,0,10"/>
                                <RadioButton Content="Comma"
                                             IsChecked="{Binding AppendComma}"
                                             VerticalContentAlignment="Center"
                                             Margin="0,0,0,10"/>
                                <RadioButton Content="None"
                                             VerticalContentAlignment="Center"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </StackPanel>
            </Border>

            <Border Background="Black"
                    Margin="20,0,0,0"
                    CornerRadius="10,0,0,10">
                <Border Background="#EEEEEE"
                        Margin="10,10,10,10"
                        CornerRadius="10">
                    <StackPanel Orientation="Vertical"
                            Margin="0,10,0,0">
                        <StackPanel Orientation="Horizontal"
                                Margin="10,0,0,0">
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,5">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding In}"/>
                                <TextBlock Text="In"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Out}"/>
                                <TextBlock Text="Out"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Stop}"/>
                                <TextBlock Text="Stop"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                Margin="10,0,0,0">
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,5">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Preset}"/>
                                <TextBlock Text="Preset"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Store}"/>
                                <TextBlock Text="Store"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Home}"/>
                                <TextBlock Text="Home"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                Margin="10,0,0,0">
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,5">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding A}"/>
                                <TextBlock Text="A"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding B}"/>
                                <TextBlock Text="B"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding C}"/>
                                <TextBlock Text="C"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                Margin="10,0,0,0">
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding D}"/>
                                <TextBlock Text="D"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,5">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding E}"/>
                                <TextBlock Text="E"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding F}"/>
                                <TextBlock Text="F"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                Margin="10,0,0,0">
                            <StackPanel Orientation="Vertical"
                                        Margin="10,0,20,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding Left}"
                                        Width="50"/>
                                <TextBlock Text="Left"
                                           Margin="0,0,0,0"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical"
                                        Margin="0,0,10,0">
                                <Button Style="{StaticResource RoundedButtonStyle}"
                                        Width="50"
                                        Command="{Binding Right}"/>
                                <TextBlock Text="Right"
                                           Margin="0,0,0,0"
                                       FontSize="14"
                                       Foreground="Black"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                Margin="20,10,0,0">
                            <TextBox Height="25"
                                     Width="80"
                                     Text="{Binding CustomText}"
                                     Margin="0,0,5,0"/>

                            <Button Style="{StaticResource RoundedButtonStyle}"
                                        Command="{Binding SendCustom}"
                                        Content="Send"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>

            <Border Background="black"
                    CornerRadius="0,10,10,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="14*"/>
                        <RowDefinition Height="20*"/>
                    </Grid.RowDefinitions>

                    <Border Background="#EEEEEE"
                        Margin="10,10,10,5"
                            CornerRadius="10,10,10,10">
                        <StackPanel Orientation="Vertical">
                            <StackPanel Orientation="Horizontal"
                                    Margin="10,10,0,0">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,0">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreA}"/>
                                    <TextBlock Text="Store A"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,5">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreB}"/>
                                    <TextBlock Text="Store B"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,0">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreC}"/>
                                    <TextBlock Text="Store C"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal"
                                    Margin="10,0,0,10">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,0">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreD}"/>
                                    <TextBlock Text="Store D"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,5">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreE}"/>
                                    <TextBlock Text="Store E"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,10,0">
                                    <Button Style="{StaticResource RoundedButtonStyle}"
                                            Command="{Binding StoreF}"/>
                                    <TextBlock Text="Store F"
                                           FontSize="14"
                                           Foreground="Black"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <StackPanel Orientation="Vertical"
                                Grid.Row="1"
                                Margin="10,0,10,10">

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Output:"
                               FontSize="11"
                               Foreground="White"
                                       VerticalAlignment="Bottom"/>

                            <Button Content="Clear"
                                    FontSize="12"
                                    Height="25"
                                    Width="40"
                                    Margin="97,0,0,0"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Command="{Binding ClearOutput}">
                            </Button>
                        </StackPanel>

                        <TextBox Text="{Binding OutputLog}"
                             TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                             Width="174"
                                 Height="170"
                                 Margin="0,0,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </StackPanel>

        <TextBlock x:Name="ScrollMessage"
                    Text=""
                   FontSize="30"
                   Foreground="Red"
                   VerticalAlignment="Top" Margin="190,145,-190,0" Grid.Row="1">
            <TextBlock.RenderTransform>
                <TranslateTransform x:Name="ScrollMessageTranslateTransform"
                                    X="410"/>
            </TextBlock.RenderTransform>
        </TextBlock>
    </Grid>
</Window>
